\chapter{Dickson's Classification Theorem for finite subgroups of $\SL_2(F)$}\label{Ch7_DicksonsClassificationTheorem}

\section{Five Lemmas}

Before we detemine the structure of $G$ in each of the 6 cases, it is necessary to prove a number of lemmas which will be used.

\begin{lemma}
    \label{IsPGroup.not_le_normalizer} 
    \lean{IsPGroup.not_le_normalizer}
    Let $H$ be a proper subgroup of a $p$-group $G$. Then $H \subsetneq N_G(H)$.
\end{lemma}
% DEPENDENCIES

\begin{proof} Let $S$ denote the set of left cosets of $H$ in $G$. That is,
\begin{align*} S = \{ x H : x \in G \}, \quad \text{and} \;\;\; |S| = [G : H] = p^k. \quad \text{ (for some $k \geq 1$)}
\end{align*}

Consider the action of $H$ on $S$ by left multiplication. We calculate the stabiliser of $xH \in S$ in $H$.
\begin{align*} \text{Stab}(xH) &= \{ y \in H : yxH = xH \}
\\ &= \{ y \in H : x^{-1}yx \in H \}.
\end{align*}

If $x \in H$ then $x^{-1}yx \in H$ for all $y \in H$. Thus the Stab$(xH) = H$ and by the Orbit-Stabiliser Theorem,
\begin{align*} |\text{Orb}(xH)| = [H : \text{Stab}(xH)] = 1.
\end{align*}

Observe that,
\begin{align*} S = \bigcup\limits_{xH \in S} \text{Orb}(xH),
\end{align*}

where the orbits are pairwise disjoint. Now since $p$ divides $|S|$, $p$ divides the sum of all the orbit sizes. Furthermore, since each orbit size is 1 or a multiple of $p$, there must be at least $p$ elements of $S$ which have an orbit of 1. In particular, there exists an $x_1 H \in S$ which has an orbit of 1 and $x_1 \not \in H$. That is,
\begin{align*} y x_1 H &= x_ 1 H, \tag{$\forall y \in H$}
\\ x_1^{-1} y x_1 &\in H,
\\ x_1^{-1} H x_1 &\subset H,
\\ x_1 &\in N_G(H) \! \setminus \! H. \qedhere
\end{align*} 

\end{proof}

\begin{lemma}
    \label{Sylow.not_normal_subgroup_of_G}
    \lean{Sylow.not_normal_subgroup_of_G}
Let $Q$ be a Sylow $p$-subgroup and $K$ a maximal abelian subgroup of $G$ such that $N_G(Q) = QK$ and $Q \cap K = \{ I_G \}$. If $[N_G(K) : K] = 2$, then $Q$ is not a normal subgroup of $G$.
\end{lemma}
% DEPENDENCIES

\begin{proof} The approach here is proof by contradiction, so we begin by assuming that $Q \vartriangleleft G$. Thus $N_G(Q) = G$ and $N_G(K) \subset N_G(Q)$. Consider the natural homomorphism of $N_G(Q)$ onto $N_G(Q)/Q$,
\begin{align*} \phi : N_G(Q) &\longrightarrow N_G(Q)/Q, \\
\phi(x) &= xQ, \\
ker(\phi) &= \{ x \in N_G(Q) : \phi(x) = I_G Q \} = Q.
\end{align*}

Let $\phi '$ be the restiction of $\phi$ to $N_G(K)$: 

\begin{equation*} \phi ' = \left.\phi\right|_{N_G(K)} : N_G(K) \longrightarrow N_G(Q)/Q.
\end{equation*}

Thus $ker(\phi ') = ker(\phi) \cap N_G(K) = Q \cap N_G(K)$. By the 1st Isomorphism Theorem,
\begin{align*} \text{Im}(\phi ') &\cong N_G(K) / ker(\phi '), \\
N_G(Q)/Q &\cong N_G(K) / (Q \cap N_G(K)), \\
K &\cong N_G(K) / (Q \cap N_G(K)) \tag{$N_G(Q) = QK$}, \\
|Q \cap N_G(K)| &= [N_G(K) : K] = 2. \tag{by assumption}
\end{align*}

So $2$ divides $|Q|$, which implies that $2 \nmid |K|$ since $Q \cap K = \{ I_G \}$. Moreover, $|Q \cap N_G(K)|$ and $|K|$ are relatively prime. \\
\\
Take $a \in ker(\phi') = Q \cap N_G(K)$ and $b \in N_G(K)$.
\begin{align*} \phi'(bab^{-1}) &= \phi'(b)\phi'(a)\phi'(b^{-1}) \\
&= \phi'(b)(I_G Q) \phi'(b^{-1}) \\
&=  \phi'(b)\phi'(b^{-1})(I_G Q) =  I_G Q. \end{align*}

Thus $bab^{-1} \in ker(\phi') = Q \cap N_G(K)$ and so $Q \cap N_G(K) \vartriangleleft N_G(K)$. \\
\\
Now let $x \in Q \cap N_G(K)$ and $y \in K$. Notice that both $x$ and $y$ are elements of $N_G(K)$,

\begin{align*} xyx^{-1}y^{-1} &=  (xyx^{-1})y^{-1} \in K, \tag{since $K \vartriangleleft N_G(K)$} \\
xyx^{-1}y^{-1} &= x(yx^{-1}y^{-1}) \in Q \cap N_G(K), \tag{since $Q \cap N_G(K) \vartriangleleft N_G(K)$} \\
xyx^{-1}y^{-1} &\in K \cap ( Q \cap N_G(K)) \\
&= I_G, \tag{since gcd$(|Q \cap N_G(K)|,|K|) = 1$} \\
xy &= yx. \\
\end{align*}

Therefore $(Q$ $\cap$ $N_G(K)) \times K$ is an abelian subgroup of which $K$ is a proper subgroup. This contradicts the fact that $K$ is a maximal abelian subgroup, thus $Q$ is not a normal subgroup of $G$.

\end{proof}

% MAY NOT BE NEEDED
\begin{lemma}
    \label{subfield} Let $p$ be the prime characteristic of $F$ and let $q= p^k$ for some $k>0$. Set,
\begin{align}\label{RRR} R = \{ \lambda \in F : \lambda^q -\lambda = 0 \}.
\end{align}
Then $R$ is a subfield of $F$.
\end{lemma}

\begin{proof} Since $R$ is a subset of $F$ it suffices to show that the following 3 criteria are met: \\
\\
(i) $0, 1 \in R$. \\
(ii) If $\lambda_1, \lambda_2 \in R$, then $\lambda_1 - \lambda_2 \in R$. \\
(iii) If $\lambda_1, \lambda_2 \in R$ and $\lambda_1 \neq 0 \neq \lambda_2$, then $\lambda_1 \lambda^{-1}_2 \in R$. \\
\\
We see immediately that (i) is satified. Since $p$ is the characteristic of $F$, any coeffiecients which are a multiple of $p$ vanish. We get,
\begin{align*} (\lambda_1 - \lambda_2)^q = (\lambda^p_1 - \lambda^p_2)^{p^{k-1}} = ... = \lambda^q_1 - \lambda^q_2 = \lambda_1 - \lambda_2.
\end{align*}

Thus $\lambda_1 - \lambda_2 \in R$ and (ii) is also satisifed. Finally observe that if $\lambda_2$ is a non-zero element of $R$, then $\lambda^{-1}_2 = \lambda^{-q}_2$ and,
\begin{align*} (\lambda_1 \lambda^{-1}_2)^q = \lambda^q_1 \lambda^{-q}_2 = \lambda_1 \lambda^{-1}_2.
\end{align*}

So $\lambda_1 \lambda^{-1}_2 \in R$ and $R$ is a subfield of $F$.

\end{proof}

Each finite field is uniquely determined up to isomorphism by the number of elements it contains \cite[p.227]{stewart}. Since the $R$ defined in \eqref{RRR} has $q$ elements, from now on when we use the notation $\mathbb{F}_q$ to denote a field of $q$ elements, we shall actually mean,
\begin{align}
    \label{subfield} \mathbb{F}_q = R \subset F.
\end{align}

\begin{lemma}
    \label{Matrix.card_GL_field}
    \lean{Matrix.card_GL_field}
    \leanok
    Let $\mathbb{F}_q$ be the field of $q$ elements, where $q$ is the power of a prime. The order of $GL(2,\mathbb{F}_q)$ is $(q^2-1)(q^2-q)$.
\end{lemma}
\begin{proof}
    In order to prove this, we again take a geometric viewpoint. Recall that $GL(2,\mathbb{F}_q)$ is the group of 2 x 2 invertible matrices over $\mathbb{F}_q$ under ordinary matrix multiplication. The order of $GL(2,\mathbb{F}_q)$ is thus equal to the number of ordered pairs $\{u,v\}$ of linearly independent vectors in a 2-dimensional vector space over $\mathbb{F}_q$. \\
    \\
    There are clearly $q^2$ different vectors in the 2-dimensional vector space over $\mathbb{F}_q$. The only restriction on the first vector $u$, is that it must be non-zero, so there are $(q^2 - 1)$ choices for $u$. To ensure the second vector $v$ is linearly independent of $u$, it must not be of the form $\alpha u$, where $\alpha \in \mathbb{F}_q$. Since there are $q$ choices for $\alpha$, there are $(q^2-q)$ choices for $v$. \\
    \\
    Thus the order of $GL(2,\mathbb{F}_q)$ is the product of the number of choices of $u$ and the number of choices of $v$, that is, $(q^2-1)(q^2-q)$ as required.
\end{proof}

\begin{lemma}
\label{card_SL_field}
\uses{Matrix.card_GL_field}
\lean{card_SL_field}

The order of $\SL_2(\mathbb{F}_q)$ is $q(q^2-1)$
\end{lemma}

\begin{proof} 
Consider the map $\phi$ defined as,
\begin{align*} \phi : GL(2,\mathbb{F}_q) \longrightarrow \mathbb{F}^*_q, \qquad \text{where} \quad \! \! \phi(x) = \text{det}(x), \quad \forall \; x \in GL(2,\mathbb{F}_q).
\end{align*}

Next we determine the kernel of $\phi$.
\begin{align*} ker(\phi) &= \{  GL(2,\mathbb{F}_q) : \text{det}(x) = 1 \} = \SL_2(\mathbb{F}_q).
\end{align*}

We show that $\phi$ is a group homomorphism. Take $x,y \in GL(2,\mathbb{F}_q)$,
\begin{align*} 
\phi(xy) = \text{det}(xy) = \text{det}(x) \text{det}(y) = \phi(x) \phi(y).
\end{align*}

Clearly $\phi$ is surjective, since $\alpha \in \mathbb{F}^*_q$ is the determinant of $\begin{bmatrix} \alpha & 0 \\ 0 & 1 \end{bmatrix} \in GL(2,\mathbb{F}_q)$. Therefore because $\SL_2(F) \lhd \GL_2(F)$, by the First Isomorphism Theorem,
\begin{align*} GL(2,\mathbb{F}_q) / \SL_2(\mathbb{F}_q) \cong \mathbb{F}^*_q.
\end{align*}
Thus,
\begin{align*} |\SL_2(\mathbb{F}_q)| =  \frac{|GL(2,\mathbb{F}_q)|}{|\mathbb{F}^*_q|} = \frac{(q^2-1)(q^2-q)}{q-1} = q(q^2-1).
\end{align*}

\end{proof}

\begin{lemma}
    \label{QuotientGroup.comapMk'OrderIso}
    \lean{QuotientGroup.comapMk'OrderIso}
Let $N$ be a normal subgroup of a group $G$ and let $H$ be a subgroup of $G$ which contains $N$.Then,
\begin{align*} H / N \vartriangleleft G / N \iff H \vartriangleleft G
\end{align*} 
\end{lemma}

\begin{proof} If $H \vartriangleleft G$, then it follows from the Third Isomorphism Theorem that $ H / N \vartriangleleft G / N$. Conversely, assume that $H / N$ is normal in $G / N$. Let $x$ be an arbitrary element of $G$ and $h$ be an arbitrary element of $H$. Since $H / N$ is normal in $G / N$ we have,
\begin{align*} x h x^{-1}N = (xN)(hN)(x^{-1}N) = (xN)(hN)(xN)^{-1} \in H / N.
\end{align*}
Thus $x h x^{-1} \in H$. Since $x$ and $h$ were chosen arbitrarily, we have that $H \vartriangleleft G$.

\end{proof}

\section {The Six Cases}

We now address individually the 6 possible combinations of $s$ and $t$ in \eqref{classeq} and determine the structure of $G$ in each case. \\
\\
\begin{theorem}[Case I]
\label{case_I}
\uses{card_noncenter_fin_subgroup_eq_sum_card_noncenter_mul_index_normalizer, MaximalAbelianSubgroup.K_mem_MaximalAbelianSubgroups_of_center_lt_card_K}
\lean{case_I}
Claim: \textit{In this case, the Sylow $p$-subgroup $Q$ is different from $G$ and is an elementary abelian normal subgroup of $G$. The factor group $G/Q$ is a cyclic group whose order is relatively prime to $p$.} \\
\\
\end{theorem}
% DEPENDENCIES AND STATEMENT
\begin{proof} Here, $s = 1$ and $t = 0$. Equation (\ref{classeq}) simplifies to:
\begin{align}\label{case1a} 1 &= \frac{1}{g} + \frac{q-1}{qk} + \frac{g_1-1}{g_1}, \nonumber
\\ 1 &= \frac{1}{g} + \frac{1}{k} - \frac{1}{qk}  + 1 - \frac{1}{g_1}, \nonumber
\\ \frac{1}{qk}  + \frac{1}{g_1} &= \frac{1}{g} + \frac{1}{k}.
\end{align}
 \space \textbf{Case Ia:} $\pmb{q = 1}$. Here we have $Q = I_G$ and is trivially an elementary abelian normal subgroup of $G$. Equation (\ref{case1a}) gives $g=g_1$, thus $G/Q = G = A_1$, which indeed is a cyclic group whose order is relatively prime to $p$. \\
\\
 \space \textbf{Case Ib:} $\pmb{q > 1}$. If $k=1$ then (\ref{case1a}) gives,
\begin{align*} \frac{1}{q}  + \frac{1}{g_1} &= \frac{1}{g} + 1 \; > \; 1.
\end{align*}
But since both $1/q$ and $1/g_i$ are at most $1/2$ each, this is a contradiction. Thus $k > 1$. This means that $|K| = ek > e = |Z|$, so $k = g_1$ by 
Theorem \ref{MaximalAbelianSubgroup.K_mem_MaximalAbelianSubgroups_of_center_lt_card_K}. Equation (\ref{case1a}) now gives $qk = g$.
\begin{align*} |G| = eg = eqk = |N_G(Q)|.
\end{align*}
Thus $G = N_G(Q)$ and so $Q \vartriangleleft G$. Therefore $Q \neq G$ and is an elementary abelian normal subgroup of $G$. Also,
\begin{align*} G/Q = N_G(Q)/Q \cong K = A_1.
\end{align*}
Thus $G/Q$ is a cyclic group whose order is relatively prime to $p$.

\end{proof}

\begin{theorem}[Case II]
\label{case_II}
\uses{card_noncenter_fin_subgroup_eq_sum_card_noncenter_mul_index_normalizer, MaximalAbelianSubgroup.of_index_normalizer_eq_two}
\lean{case_II}
Claim: \textit{The order of $G$ is relatively prime to $p$ and either $G \cong \SL_2(3)$ or $G$ is the group of order $4n$, where $n$ is odd, defined by the presentation:}
\begin{align*} \langle \, x,y \, | \, x^n = y^2, \, yxy^{-1} = x^{-1} \, \rangle. \\
\end{align*}
\end{theorem}
% DEPENDENCIES AND STATEMENT
\begin{proof} Here, $s = 1 = t$. Equation (\ref{classeq}) simplifies to:
\begin{align}\label{case2a} 1 &= \frac{1}{g} + \frac{q-1}{qk} + \frac{g_1-1}{g_1} +  \frac{g_2-1}{2g_2}, \nonumber
\\ 1 &= \frac{1}{g} + \frac{q-1}{qk} + 1 - \frac{1}{g_1} + \frac{1}{2} - \frac{1}{2g_2}, \nonumber
\\ \frac{1}{g_1}  + \frac{1}{2g_2} &= \frac{1}{2} + \frac{1}{g} + \frac{q-1}{qk}.
\end{align}

First assume that $q>1$. This means $(q-1)/qk \geq 1/2k$ and consequently we bound (\ref{case2a}) from below:
\begin{align*} \frac{1}{2g_2} &= \frac{1}{2} - \frac{1}{g_1} + \frac{1}{g} + \frac{q-1}{qk} \; > \; \frac{1}{2k}.
\end{align*}

Thus $k > g_2 \geq 2$. So $K \in \mathfrak{M}$ and $k=g_i$ for some $i$. Since it is strictly greater than $g_2$, we have $k=g_1$. Equation (\ref{case2a}) now becomes
\begin{align*} \frac{1}{g_1}  + \frac{1}{2g_2} \; &= \; \frac{1}{2} + \frac{1}{g} + \frac{q-1}{qg_1},
\\ \frac{1}{g_1}  + \frac{1}{2g_2} \; &> \; \frac{1}{2} + \frac{1}{2g_1},
\\ \frac{1}{4} + \frac{1}{4} \; \geq \; \frac{1}{2g_1}  + \frac{1}{2g_2} \; &> \; \frac{1}{2}.
\end{align*}

This contradiction disproves the assumption that $q > 1$, so we have that $q = 1$. This means that $Q$, a Sylow $p$-subgroup of $G$, is simply the identity element and so $|G|$ is relatively prime to $p$. Also, Equation (\ref{case2a}) now reduces to:
\begin{align}\label{case2b} \frac{1}{g_1}  + \frac{1}{2g_2} &= \frac{1}{2} + \frac{1}{g}.
\end{align}

If $g_1 \geq 4$ we get
\begin{align*} \frac{1}{2g_2} &= \frac{1}{2} + \frac{1}{g} - \frac{1}{g_1} \; > \; \frac{1}{4}.
\end{align*}

Since $g_2 > 1$  this gives a contradiction and thus $g_1 < 4$. We now have two seperate cases to consider.\\
\\
 \space \textbf{Case IIa:} $\pmb{g_1 = 2}$. Equation (\ref{case2b}) becomes
\begin{align*} \frac{1}{2g_2} &= \frac{1}{g}, \; \; \Longrightarrow \; \; g = 2g_2.
\end{align*}

If $e=1$, then $p=2$. Also since $q=1$, 2 does not divide $|G|$, but $|G| = eg = e2g_2$ which is a contradiction. So $e=2$ and $p \neq 2$. We now have:
\begin{align*} |N_G(A_2)| &= 2|A_2|  = 2eg_2 = eg = |G|,  \tag{since $s+t = 2$}
\\ |N_G(A_1)| &= |A_1| = eg_1 = 4. \tag{since $s=1$} 
\end{align*}
Thus $G = N_G(A_2)$, that is $A_2 \vartriangleleft G$.\\
\\
By Corollary \ref{5thsylow}, $A_1$ is contained in a Sylow 2-subgroup of $G$, call it $S$. If $S$ is strictly larger than $A_1$, then by Lemma \ref{case2q}, $A_1 \subsetneq N_S(A_1) \subset N_G(A_1)$. Since $A_1 = N_G(A_1)$ we conclude that $A_1$ is a Sylow 2-subgroup of $G$. This means that 8 does not divide $|G| = 4g_2$ and so $g_2 = n$, where $n$ is odd. \\
\\
Since $A_2$ is cyclic it is generated by a single element, so let $A_2 = \langle x \rangle$ and thus $x^{2n}= I_G$.  Recall that because $[N_G(A_2): A_2] = 2$, Theorem \ref{MaximalAbelianSubgroup.of_index_normalizer_eq_two} tells us that there exists a $y \in N_G(A_2) \! \setminus \! A_2$ such that $yxy^{-1} = x^{-1}$. \\
\\
Recall from Chapter 2 that the number of $A_i$ in each conjugacy class $\mathcal{C}_i$ is equal to $[G : N_G(A_i)]$ so,
\begin{align*}  |\mathcal{C}_2| = [G:N_G(A_2)] &= 1.
\end{align*}

Due to the fact that $y$ belongs to some maximal abelian subgroup of $G$, and since $y \not \in A_2$ and $|\mathcal{C}_2| = 1$, it must be that $y$ belongs to $A_1$ or one of its conjugate subgroups. Thus $y$ has an order which divides $|A_1| = 4$ and since the only elements of order 1 and 2 lie in $Z$, the order of $y$ is 4. Furthermore, both $x^n$ and $y^2$ have order 2. Recalling that $G$ has at most 1 element of order 2, this gives the relation $x^n = y^2$. \\ 
\\
Let $H$ be the group generated by $x$ and $y$ and the above relations:
\begin{align*} H = \langle \, x,y \, | \, x^n = y^2, \, yxy^{-1} = x^{-1} \rangle.
\end{align*}

Notice that the second relation gives that $y x^n y^{-1} = x^{-n}$, so
\begin{align*} x^{-n} = y x^n y^{-1} = y y^2 y^{-1} = y^2 = x^n.
\end{align*}

This shows that $y^4 = x^{2n} = I_G$ and that $H$ is finite. Moreoever,
\begin{align*} H = \{ x^k, x^ky :  0 < k \leq 2n \}.
\end{align*}

 Thus $|H| = 4n = |G|$ and $H = G$. \\
\\
 \space \textbf{Case IIb:} $\pmb{g_1 = 3}$.  Equation (\ref{case2b}) becomes
\begin{align*} \frac{1}{2g_2} &= \frac{1}{6} + \frac{1}{g} \; > \; \frac{1}{6}.
\end{align*}
Therefore $g_2 = 2$ and $g = 12$. Again, since $q=1$ and 2 divides $|G|$, we have $p \neq 2$ and so $e = 2$. Thus we have,
\begin{align*} |G| = eg = 24, \qquad |A_1| = eg_1 = 6, \qquad |A_2| = eg_2 = 4.
\end{align*}
Again we determine the number of maximal abelian subgroups in each conjugacy class.
\begin{align*}  |\mathcal{C}_1| = [G:N_G(A_1)] &= \frac{|G|}{|A_1|} = \frac{24}{6} = 4, 
\\[1.5ex] |\mathcal{C}_2| = [G:N_G(A_2)] &= \frac{|G|}{2|A_2|} = \frac{24}{8} = 3.
\end{align*}

% \newpage
The figure below shows $G$ divided into it's maximal abelian subgroups:


% \begin{center}
% \begin{tikzpicture}[thick, scale=0.4]

% \draw[dashed][rotate around={0:(0,0)},red] (3,0) ellipse (108pt and 41pt);  
% \draw[dashed][rotate around={20:(0,0)},red] (3,0) ellipse (108pt and 41pt);  
% \draw[rotate around={40:(0,0)},red] (3,0) ellipse (108pt and 41pt); 
% \draw[dashed][rotate around={60:(0,0)},red] (3,0) ellipse (108pt and 41pt);  

% \draw[dashed][rotate around={180:(0,0)},blue] (2,0) ellipse (79pt and 37pt);  
% \draw[rotate around={210:(0,0)},blue] (2,0) ellipse (79pt and 37pt);
% \draw[dashed][rotate around={240:(0,0)},blue] (2,0) ellipse (79pt and 37pt);

% \draw (0,0) ellipse (22pt and 22pt); 

% \node[] at (0,-8) {\resizebox{9cm}{!}{Fig 2: The elements of $G$ arranged into maximal abelian subgroups.}};
% \node[] at (0,0) {\resizebox{.3cm}{!}{$Z$}};
% \node[] at (5.7,4.9) {\resizebox{.5cm}{!}{$A_1$}};
% \node[] at (-4.6,-2.8) {\resizebox{.5cm}{!}{$A_2$}};
% \node[] at (8.6,5) {\resizebox{.5cm}{!}{$\mathcal{C}_1$}};
% \node[] at (-6.8,-3.6) {\resizebox{.5cm}{!}{$\mathcal{C}_2$}};

% \node[scale=1.8, rotate=30,gray] at (-5.4,-3.2) { $\Bigg\{$ };
% \node[scale=2, rotate=210,gray] at (7.3,4) { $\Bigg\{$ };

% \node[scale=2, black] at (-.45,0) {.};
% \node[scale=2, black] at (.45,0) {.};

% \node[scale=3, red] at (4,4) {.};
% \node[scale=3, red] at (4.7,4.2) {.};
% \node[scale=3, red] at (4.8,3.3) {.};
% \node[scale=3, red] at (3.9, 3.2) {.};
% \node[scale=2, red] at (4.8, 1.7) {.};
% \node[scale=2, red] at (5.2, 2.3) {.};
% \node[scale=2, red] at (5.9, 2.2) {.};
% \node[scale=2, red] at (5.6, 1.5) {.};
% \node[scale=2, red] at (6, 0.2) {.};
% \node[scale=2, red] at (5.5, -0.5) {.};
% \node[scale=2, red] at (4.6, -0.8) {.};
% \node[scale=2, red] at (3.7, -1) {.};
% \node[scale=2, red] at (3, 5.2) {.};
% \node[scale=2, red] at (2.2,4.5) {.};
% \node[scale=2, red] at (1.5, 4.0) {.};
% \node[scale=2, red] at (0.9, 3.3) {.};

% \node[scale=3, blue] at (-3.5,-1.6) {.};
% \node[scale=3, blue] at (-3.2,-2.4) {.};
% \node[scale=2, blue] at (-3.6,0.4) {.};
% \node[scale=2, blue] at (-2.4,0.6) {.};
% \node[scale=2, blue] at (-2,-3.3) {.};
% \node[scale=2, blue] at (-1.0,-2.9) {.};

% \end{tikzpicture}
% \end{center}

Let $A_2 = \langle x \rangle$. By Theorem \ref{MaximalAbelianSubgroup.of_index_normalizer_eq_two}, there is an element $y \in N_G(A_2) \! \setminus \! A_2$ such that $y x y^{-1} = x^{-1}$. Since $N_G(A_2)$ has order 8, the order of $y$ must divide 8. The order of $y$ cannot be 8 since $N_G(A_2)$ is not cyclic and the only elements with order 1 or 2  are found in $Z$, thus $y$ has order 4. By the uniqueness of the element of order 2, we have $x^2 = y^2$. So
\begin{align*} N_G(A_2) = \langle x, y \; | \; x^2 = y^2, y x y^{-1} = x^{-1} \rangle.
\end{align*}
For simplicity let $N = N_G(A_2)$ . Since $|A_1| = 6$, the only elements in $C_1$ with order $2^k$ are those in $Z$, so every element of $G$ with order $2^k$ must belong to $C_2$. Since $C_2$ has order 8 it is equal to $N$ because each element of $N$ has order $2^k$. Furthermore, $N$ is thus a unique Sylow $2$-subgroup of $G$ and by Corollary \ref{4thsylow}, we have $N \vartriangleleft G$. \\
\\
Now consider the quotient group $G / N$, that is the set of left (or right) cosets of $N$ in $G$.
\begin {align*} G / N = \{ N, rN, r^2N \} \cong \langle r \rangle \cong \mathbb{Z}_3,
\end{align*}
where $r$ is some element of $G\! \setminus \! N$ with order 3. Without loss of generality we may regard $r$ to be a generator of $H$, where $H$ is the cyclic subgroup of $A_1$ of order 3. \\
\\
Let $H$ act on $N$ by conjugation. Since $|H| = 3$ the orbit of $x \in N$ has size 1 or 3.
\begin{align*} \text{Orb}(x) =  \{ r^k x r^{-k} : r^k \in H \}.
\end{align*}

Since $H$ is not contained in the centraliser of $x$ we conclude that the orbit of $x$ has size 3. Let $A_2, A'_2$ and $A''_2$ be the 3 elements of $\mathcal{C}_2$. Without loss of generality we may assume $y \in A'_2$ and consequently $xy \in A''_2$. Using the two relations between $x$ and $y$ we observe that,
\begin{align*} (xy)^{-1} = y^{-1} x^{-1} = y^{-1} (y x y^{-1}) = x y^{-1} = x^{-1} x^2 y^{-1} = x^{-1} y = yx
\end{align*}

% \begin{center}
% \begin{tikzpicture}[thick, scale=0.8]

% \draw[rotate around={60:(0,0)},blue] (2,0) ellipse (79pt and 37pt);  
% \draw[rotate around={90:(0,0)},blue] (2,0) ellipse (79pt and 37pt);
% \draw[rotate around={120:(0,0)},blue] (2,0) ellipse (79pt and 37pt);

% \draw (0,0) ellipse (22pt and 22pt); 

% \node[] at (0,-2) {\resizebox{9cm}{!}{Fig 3: The elements of $N$ arranged into maximal abelian subgroups.}};
% \node[] at (0,0) {\resizebox{.3cm}{!}{$Z$}};
% \node[] at (-2.5,4.7) {\resizebox{.5cm}{!}{$A_2$}};
% \node[] at (0.0,5.4) {\resizebox{.5cm}{!}{$A'_2$}};
% \node[] at (2.3,4.8) {\resizebox{.5cm}{!}{$A''_2$}};

% \node[scale=3, black] at (-.45,0) {.};
% \node[scale=3, black] at (.45,0) {.};

% \node[scale=3, blue] at (-1.7, 3.3) {.};
% \node[] at (-1.7,3.6) {\resizebox{.22cm}{!}{$x$}};
% \node[scale=3, blue] at (-2.2, 2.5) {.};
% \node[] at (-2.2,2.9) {\resizebox{.6cm}{!}{$x^{-1}$}};
% \node[scale=3, blue] at (-0.5,3.8) {.};
% \node[] at (0.5,4.2) {\resizebox{.21cm}{!}{$y$}};
% \node[scale=3, blue] at (0.5,3.8) {.};
% \node[] at (-0.25,4.3) {\resizebox{.6cm}{!}{$y^{-1}$}};
% \node[scale=3, blue] at (1.7,3.3) {.};
% \node[] at (1.7,3.6) {\resizebox{.4cm}{!}{$xy$}};
% \node[scale=3, blue] at (2.2,2.5) {.};
% \node[] at (2.2,2.8) {\resizebox{.4cm}{!}{$yx$}};

% \end{tikzpicture}
% \end{center}

The elements of $Z$ are fixed points under this group action and the remaining 6 elements of $N$ form 2 orbit cycles of order 3, with each cycle containing exactly one element from the noncentral parts of $A_2, A'_2$ and $A''_2$ in some order. If $y$ inverts $x$, then $y$ inverts all powers of $x$ including $x^{-1}$. Also, if $y$ inverts $x$, then $y^{-1}$ inverts $x^{-1}$ and thus inverts $x$ also. So the 2 relations we have established between $x$ and $y$ actually hold for any pair of elements of $N \! \setminus \! Z$ which belong to different elements of $\mathfrak{M}$. Therefore without loss of generality, we may assume that $x$ and $y$ are in the same orbit cycle and that $r x r^{-1} = y$. Fig 3 shows that there are only 2 elements which could complete this cycle, $xy$ and $yx$. If $r y r^{-1} = xy$, then we have the following 3 relations on $G$.
\begin{align}\label{3rel} r x r^{-1} = y, \qquad r y r^{-1} = xy, \qquad r xy x^{-1} = x.
\end{align}

Otherwise $r y r^{-1} = yx$. In this case, consider the orbit of $x$ under conjugation by $r^2$ instead. This gives the same orbit cycle but in the opposite direction:
\begin{align*} r^2 x r^{-2} = yx, \qquad r^2 yx r^{-2} = y, \qquad r^2 y r^{-2} = x.
\end{align*}
Observe that $x(yx) = x (x^{-1} y) = y$. Thus without loss of generality we can rename $r^2$ as $r$, $yx$ as $y$ and $y$ as $xy$. Notice that this now gives the same relations as in \eqref{3rel}. Since $x$ and $y$ generate a group of order 8 and $r$ has order 3, the group given by the following presentation has order at most 24 and is thus a presentation of $G$. 
\begin{align*} \langle x, y, r \, |  \, x^2= y^2, \, y x y^{-1} = x^{-1}, \, r^3 = I, \, r x r^{-1} = y, \, r y r^{-1} = xy, \, r xy r^{-1} = x \rangle,
\end{align*}

By Lemma \ref{ordersl2q}, we observe that the order of $\SL_2(3)$ is $3(3^2-1) = 24$. Now consider the following the elements of $\SL_2(3)$:
\begin{align*} a = \begin{bmatrix} 1 & 1 \\ 1 & 2 \end{bmatrix}, \qquad b = \begin{bmatrix} 0 & 2 \\ 1 & 0 \end{bmatrix}, \qquad c = \begin{bmatrix} 2 & 1 \\ 2 & 0 \end{bmatrix}.
\end{align*}

One can verify easily that each of the following relations hold:
\begin{align*} a^2 &= b^2, \qquad b a b^{-1} = a^{-1}, \qquad \quad \; c^3 = I, 
\\ c a c^{-1} &= b,  \qquad \; \: c b c^{-1} = ab, \qquad \! c ab c^{-1} = a.
\end{align*}

Since $G$ and $\SL_2(3)$ have the same order and since their respective generators satisfy the corresponding relations, there is an isomorphism mapping $x \mapsto a$, $y \mapsto b$ and $r \mapsto c$. Thus,
\begin{align*} G = \langle x, y, r \rangle \cong \langle a, b, c \rangle = \SL_2(3). 
\end{align*} 
\end{proof}


\begin{theorem}[Case III]
\label{case_III}
\uses{card_noncenter_fin_subgroup_eq_sum_card_noncenter_mul_index_normalizer, MaximalAbelianSubgroup.K_mem_MaximalAbelianSubgroups_of_center_lt_card_K}
\lean{case_III}
Claim: \textit{We have $G = Q \times Z$.}
\end{theorem}
% DEPENDENCIES AND STATEMENT
\begin{proof} Here, $s = 0 = t$. Equation (\ref{classeq}) simplifies to:
\begin{align}\label{case3a} 1 &= \frac{1}{g} + \frac{q-1}{qk}, \nonumber
\\ 1 &= \frac{1}{g} + \frac{1}{k} - \frac{1}{qk}, \nonumber
\\ 1 + \frac{1}{qk} &= \frac{1}{g} + \frac{1}{k}.
\end{align}

Since $s = 0 = t$, there are no cyclic maximal abelian subgroups whose order is relatively prime to $p$, so $K \not \in \mathfrak{M}$. Then by Theorem \ref{MaximalAbelianSubgroup.K_mem_MaximalAbelianSubgroups_of_center_lt_card_K} we have,
\begin{align*} ek = |K| \leq |Z| = e.
\end{align*} 
Thus $k = 1$ and equation (\ref{case3a}) reduces to $1/q = 1/g$, that is $g=q$.
\begin{align*} |G| =  eg &= eq = |Q \times Z|,
\\ G &= Q \times Z.
\end{align*}
\qedhere
\end{proof}


\begin{theorem}[Case IV]
\label{case_IV}
\lean{card_noncenter_fin_subgroup_eq_sum_card_noncenter_mul_index_normalizer}
\lean{case_IV}
Claim: \textit{Either $p=2$ and $G$ is isomorphic to the dihedral group of order $2n$, where $n$ is odd, or $p=3$ and $G \cong \SL_2(3)$.}
\end{theorem}
\begin{proof} Here, $s = 0$ and $t = 1$. Equation (\ref{classeq}) simplifies to:
\begin{align}\label{case4a} 1 &= \frac{1}{g} + \frac{q-1}{qk} +  \frac{g_1-1}{2g_1}, \nonumber
\\ 1 &= \frac{1}{g} + \frac{q-1}{qk} + \frac{1}{2} - \frac{1}{2g_1}, \nonumber
\\ \frac{1}{2} + \frac{1}{2g_1} &= \frac{1}{g} + \frac{q-1}{qk}.
\end{align}

Recall that $|A_1|=eg_1$ and $[N_G(A_1): A_1] = 2$ and so,
\begin{align*} eg = |G| \geq |N_G(A_1)| = 2eg_1.
\end{align*}

So $g \geq 2g_1$ and $1/2g_1 \geq 1/g$ and hence we can bound Equation (\ref{case4a}):
\begin{align*} \frac{1}{2} \; \leq \; \frac{1}{2} + \frac{1}{2g_1} - \frac{1}{g} &= \frac{q-1}{qk}.
\end{align*}

Clearly this forces $k = 1$ and also $q > 1$. We can now simplify and bound Equation (\ref{case4a}) as follows:
\begin{align*} \frac{1}{q} + \frac{1}{4} \; \geq \; \frac{1}{q} + \frac{1}{2g_1} &= \frac{1}{g} + \frac{1}{2} \; > \; \frac{1}{2}. 
\end{align*}

This gives $1/q > 1/4$ and so $q$ is equal to either 2 or 3. We examine each case individually. \\
\\
 \space \textbf{Case IVa:} $\pmb{q = 2}$. Equation (\ref{case4a}) becomes
\begin{align*} \frac{1}{2g_1} &= \frac{1}{g}, \; \; \Longrightarrow \; \; g = 2g_1,
\end{align*}

and we show that $A_1$ is a normal subgroup of $G$:
\begin{align*} |G| = eg = e2g_1 = 2|A_1| = |N_G(A_1)|. 
\end{align*}
In this case, a Sylow $p$-subgroup has order 2 so we have $p=2$ and also $e=1$. By it's definition, the order of $A_1$ is relatively prime to $p=2$, so we have that $|A_1|= g_1 = n$, where $n$ is odd, and consequently $G$ has order $2n$. \\  
\\
We now know enough about the structure of $G$ to establish some relations on it. Let $A_1 = \langle x \rangle$, so $x^n = I_G$. By Theorem \ref{MaximalAbelianSubgroup.of_index_normalizer_eq_two} there exists a $y \in N_G(A_1) \! \setminus \! A_1$ such that $y x y^{-1} = x^{-1}$.
\begin{align*} |\mathcal{C}_1| &= [G : N_G(A_1)] = 1.
\\ |\mathcal{C}_{Q \times Z}| &= [G : N_G(Q \times Z)] = \frac{|G|}{eqk} = \frac{2n}{2} = n.
\end{align*}
The only maximal abelian subgroups of $G$ are thus $A_1$ and the $n$ conjugate subgroups of $\mathcal{C}_{Q \times Z}$.

% \begin{center}
% \begin{tikzpicture}[thick, scale=0.4]

% \draw[rotate around={0:(0,0)},green] (3,0) ellipse (108pt and 41pt);  
% \draw[dashed][rotate around={20:(0,0)},green] (3,0) ellipse (108pt and 41pt);  
% \draw[dashed][rotate around={40:(0,0)},green] (3,0) ellipse (108pt and 41pt); 
% \draw[dashed][rotate around={60:(0,0)},lightgray] (3,0) ellipse (108pt and 41pt);  
% \draw[dashed][rotate around={80:(0,0)},lightgray] (3,0) ellipse (108pt and 41pt);  
% \draw[dashed][rotate around={100:(0,0)},lightgray] (3,0) ellipse (108pt and 41pt);  
% \draw[dashed][rotate around={120:(0,0)},green] (3,0) ellipse (108pt and 41pt);  

% \draw[rotate around={210:(0,0)},blue] (3,0) ellipse (108pt and 41pt);

% \draw (0,0) ellipse (22pt and 22pt); 

% \node[] at (0,-6) {\resizebox{9cm}{!}{Fig 4: The elements of $G$ arranged into maximal abelian subgroups.}};
% \node[] at (0,0) {\resizebox{.3cm}{!}{$Z$}};
% \node[] at (8.4,0.2) {\resizebox{1cm}{!}{$Q \times Z$}};
% \node[] at (-6.8,-3.1) {\resizebox{.5cm}{!}{$A_1$}};
% \node[] at (4.7,8.3) {\resizebox{1.1cm}{!}{$\mathcal{C}_{Q \times Z}$}};

% \node[scale=2.5, rotate=240,gray] at (4.0,6.7) { $\Bigg\{$ };

% \node[scale=2, black] at (-.45,0) {.};

% \node[scale=3, green] at (5.5, -0.1) {.};
% \node[scale=2, green] at (5.5, 2.0) {.};
% \node[scale=2, green] at (4.5,3.7) {.};
% \node[scale=1.3, gray] at (2.8,5.0) {.};
% \node[scale=1.3, gray] at (1.1,5.7) {.};
% \node[scale=1.3, gray] at (-0.9,5.7) {.};
% \node[scale=2, green] at (-2.8, 4.8) {.};

% \node[scale=1.6, blue] at (-5.1,-3.0) {.};
% \node[scale=3, blue] at (-3.4,-2.4) {.};
% \node[scale=1.6, blue] at (-3.6,-1.4) {.};
% \node[scale=1.6, blue] at (-2.4,-0.7) {.};
% \node[scale=1.6, blue] at (-2,-1.9) {.};
% \node[scale=1.6, blue] at (-0.8,-1.2) {.};

% \end{tikzpicture}
% \end{center}

Since $y$ belongs to some maximal abelian subgroup and $y \not \in A_1$, $y$ must belong to some element of $\mathcal{C}_{Q \times Z}$. Since $|Q \times Z|$ = 2, the order of $y$ is 2 and $y^2 = I_G$. We have established the following presentation of G.
\begin{align*} G = \langle x, y \; | \; x^n = I_G = y^2, \; y x y^{-1} = x^{-1} \rangle.
\end{align*}

Let $D_n$ denote the dihedral group of order $2n$, that is the group of symmetries of a regular polygon wih $n$ vertices. Let $r$ denote a clockwise rotation by $2\theta /n$ radians and $s$ denote a reflection. For $n$ odd, it can easily be verified that $D_n$ has the following presentation.
\begin{align*} D_n = \langle r, s \; | \; r^n = I = s^2, \; s r s^{-1} = r^{-1} \rangle.
\end{align*}

Since $G$ and $D_n$ have the same order and since their respective generators satisfy the corresponding relations, there is an isomorphism mapping $x \mapsto r$ and $y \mapsto s$. Thus,
\begin{align*} G = \langle x, y \rangle \cong \langle r, s \rangle = D_n.
\end{align*}

 \space \textbf{Case IVb:} $\pmb{q = 3}$. Now equation (\ref{case4a}) becomes
\begin{align*} \frac{1}{2g_1} &= \frac{1}{g} + \frac{1}{6} \; > \; \frac{1}{6}.
\end{align*}
This means that $g_1 = 2$ and $g = 12$. Since $q=3$ we have $p=3$ and $e=2$. Furthermore we have,
\begin{align*} |G| = 24, \quad |A_1| &= 4,  \quad |N_G(A_1)| = 8, \quad |Q \times Z| = 6 \quad |N_G(Q \times Z)| = 6
\end{align*}
\begin{align*} |\mathcal{C}_1| &= [G : N_G(A_1)] = \frac{24}{8} = 3
\\ |\mathcal{C}_{Q \times Z}| &= [G : N_G(Q \times Z)] = \frac{24}{6} = 4
\end{align*}
% \begin{center}
% \begin{tikzpicture}[thick, scale=0.4]

% \draw[dashed][rotate around={0:(0,0)},green] (3,0) ellipse (108pt and 41pt);  
% \draw[dashed][rotate around={20:(0,0)},green] (3,0) ellipse (108pt and 41pt);  
% \draw[rotate around={40:(0,0)},green] (3,0) ellipse (108pt and 41pt); 
% \draw[dashed][rotate around={60:(0,0)},green] (3,0) ellipse (108pt and 41pt);  

% \draw[dashed][rotate around={180:(0,0)},blue] (2,0) ellipse (79pt and 37pt);  
% \draw[rotate around={210:(0,0)},blue] (2,0) ellipse (79pt and 37pt);
% \draw[dashed][rotate around={240:(0,0)},blue] (2,0) ellipse (79pt and 37pt);

% \draw (0,0) ellipse (22pt and 22pt); 

% \node[] at (0,-7) {\resizebox{9cm}{!}{Fig 5: The elements of $G$ arranged into maximal abelian subgroups.}};
% \node[] at (0,0) {\resizebox{.3cm}{!}{$Z$}};
% \node[] at (5.4,5.2) {\resizebox{1cm}{!}{$Q \times Z$}};
% \node[] at (-4.6,-2.8) {\resizebox{.5cm}{!}{$A_1$}};
% \node[] at (9.3,5.3) {\resizebox{1.1cm}{!}{$\mathcal{C}_{Q \times Z}$}};
% \node[] at (-6.8,-3.6) {\resizebox{.5cm}{!}{$\mathcal{C}_1$}};

% \node[scale=1.8, rotate=30,gray] at (-5.4,-3.2) { $\Bigg\{$ };
% \node[scale=2, rotate=210,gray] at (7.7,4.4) { $\Bigg\{$ };

% \node[scale=2, black] at (-.45,0) {.};
% \node[scale=2, black] at (.45,0) {.};

% \node[scale=3, green] at (4,4) {.};
% \node[scale=3, green] at (4.7,4.2) {.};
% \node[scale=3, green] at (4.8,3.3) {.};
% \node[scale=3, green] at (3.9, 3.2) {.};
% \node[scale=2, green] at (4.8, 1.7) {.};
% \node[scale=2, green] at (5.2, 2.3) {.};
% \node[scale=2, green] at (5.9, 2.2) {.};
% \node[scale=2, green] at (5.6, 1.5) {.};
% \node[scale=2, green] at (6, 0.2) {.};
% \node[scale=2, green] at (5.5, -0.5) {.};
% \node[scale=2, green] at (4.6, -0.8) {.};
% \node[scale=2, green] at (3.7, -1) {.};
% \node[scale=2, green] at (3, 5.2) {.};
% \node[scale=2, green] at (2.2,4.5) {.};
% \node[scale=2, green] at (1.5, 4.0) {.};
% \node[scale=2, green] at (0.9, 3.3) {.};

% \node[scale=3, blue] at (-3.5,-1.6) {.};
% \node[scale=3, blue] at (-3.2,-2.4) {.};
% \node[scale=2, blue] at (-3.6,0.4) {.};
% \node[scale=2, blue] at (-2.4,0.6) {.};
% \node[scale=2, blue] at (-2,-3.3) {.};
% \node[scale=2, blue] at (-1.0,-2.9) {.};

% \end{tikzpicture}
% \end{center}

Notice that Fig 5 is almost identical to Fig 2 in the study of Case IIb. This is a strong indication that these 2 cases are isomorphic to each other and hence also to $\SL_2(3)$, albeit not a proof. However, an argument analogous to the one outlined in the proof of Case IIb can be directly applied here with a simple renaming of the conjugacy classes and representatives. It would be to repeat this argument again and I will leave it to the reader to verify.

\end{proof}
\begin{theorem}[Case V]
\label{case_V}
\uses{card_noncenter_fin_subgroup_eq_sum_card_noncenter_mul_index_normalizer, MaximalAbelianSubgroup.K_mem_MaximalAbelianSubgroups_of_center_lt_card_K, MaximalAbelianSubgroup.IsCyclic_and_card_coprime_CharP_or_eq_Q_join_Z}
\lean{case_V}
Claim: \textit{We have one of the following three cases: \\
\\
(i) $G \cong \SL_2(\mathbb{F}_q)$. \\
\\
(ii) $G \cong \langle \SL_2(\mathbb{F}_q), d_\pi \rangle$, where $\pi \in \mathbb{F}_{q^2} \setminus \mathbb{F}_q$, $\pi^2 \in \mathbb{F}_q$ and $\SL_2(\mathbb{F}_q) \vartriangleleft G$. \\
\\
(iii) $G \cong \SL_2(5)$ and $p=3=q$.}
\end{theorem}

\begin{proof} Here, $s = 0$ and $t = 2$. Equation (\ref{classeq}) simplifies to:
\begin{align} \label{case5a} 1 &= \frac{1}{g} + \frac{q-1}{qk} + \frac{g_1 -1}{2g_1} + \frac{g_2 -1}{2g_2}, \nonumber
\\ 
\frac{1}{2g_1} + \frac{1}{2g_2} &= \frac{1}{g} + \frac{q-1}{qk}. \end{align}

Recall that,
\begin{align*} eg = |G| \geq  |N_G(A_i)| \geq 2eg_i, \qquad \text{thus} \quad \! \frac{1}{g} \leq \frac{1}{2g_i}.
\end{align*}
Equation (\ref{case5a}) is therefore bounded from below:
\begin{align*}  \frac{2}{g} \leq \frac{1}{2g_1} + \frac{1}{2g_2} = \frac{1}{g} + \frac{q-1}{qk}. 
\end{align*}
Therefore $q>1$, since if $q=1$ we arrive at the contradiction $2/g \leq 1/g$. With this in mind we have $(q-1)/q \geq 1/2$ and since $g_i \geq 2$ this allows us to bound (\ref{case5a}) on either side.

\begin{align*} \frac{1}{2} &\geq \frac{1}{2g_1} + \frac{1}{2g_2} = \frac{1}{g} + \frac{q-1}{qk} > \frac{q-1}{qk} \geq \frac{1}{2k}.
\end{align*}

This gives $k > 1$ and so by Theorem \ref{MaximalAbelianSubgroup.K_mem_MaximalAbelianSubgroups_of_center_lt_card_K}, $k$ must equal $g_1$ or $g_2$ since the inequality $ek = |K| > |Z| = e$ holds. Without loss of generality we let $k=g_1$ and (\ref{case5a}) becomes,

\begin{align} \label{case5b} \frac{1}{2g_1} + \frac{1}{2g_2} &= \frac{1}{g} + \frac{q-1}{qg_1} = \frac{1}{g} + \frac{1}{g_1} - \frac{1}{qg_1}, \nonumber \\[1.5ex]
 \frac{1}{2g_2} &= \frac{1}{g} + \frac{1}{2g_1} - \frac{1}{qg_1}.
\end{align}
\\
Let $N_G(Q)$ act on $Q \! \setminus \! I_G$ by conjugation and consider the stabiliser in $N_G(Q)$ of an arbitrarily chosen $x \in Q \! \setminus \! I_G$.
\begin{align*} \text{Stab}(x) &= \{ g \in N_G(Q) : g x g^{-1} = x \}
\\ &= C_G(x) \cap N_G(Q)
\\ &= (Q \times Z) \cap N_G(Q) \tag{by Theorem \ref{MaximalAbelianSubgroup.IsCyclic_and_card_coprime_CharP_or_eq_Q_join_Z}}
\\ &= Q \times Z. \tag{since $Q \times Z \subset N_G(Q)$}
\end{align*}

Thus by the Orbit-Stabiliser Theorem,
\begin{align*} |\text{Orb}(x)| = [N_G(Q) : Q \times Z] = \frac{eqk}{eq} = k
\end{align*}

Since $x$ was chosen arbitrarily from $Q \! \setminus \! I_G$, each element of $Q \! \setminus \! I_G$ has an orbit in $N_G(Q)$ of size $k$. Considering also the fact that $Q \! \setminus \! I_G$ is equal to the union of the pairwise disjoint orbits of its elements, we conclude that $k = g_1$ divides $|Q \! \setminus \! I_G|$. Thus there exists some $d \in \mathbb{Z^+}$ such that,
\begin{align}\label{6.14} q-1 = d g_1.
\end{align}

Now set,
\begin{align} \label{6.14a} i = \frac{2 g_1 g_2 q}{g} > 0,
\end{align}
and multiply \eqref{case5b} by $ig$ to give,
\begin{align}\label{6.15} g_1 q &= i + (q-2) g_2.
\end{align}
Thus $i$ is an integer and since it is greater than zero by definition, \eqref{6.15} gives,
\begin{align}\label{6.16b} g_1 > \frac{(q-2) g_2}{q}.
\end{align}
Also, using \eqref{6.14} and \eqref{6.15} we get,
\begin{align}\label{6.16a} g_1 q &= i + (q-1) g_2 - g_2 \nonumber
\\ &= i + d g_1 g_2 - g_2, \nonumber
\\ g_2 &= i + (d g_2 - q) g_1.
\end{align}

Applying Lemma \ref{caseVlemma} we observe that $Q$ is not normal in $G$, and so 
\begin{align*} eg = |G| &> |N_G(Q)| = eqk = eqg_1, \\[1.5ex]
\frac{1}{qg_1} &> \frac{1}{g}.
\end{align*}
And (\ref{case5b}) gives us,
\begin{align}\label{6.13}  \frac{1}{2g_2} &= \frac{1}{g} - \frac{1}{qg_1} + \frac{1}{2g_1} < \frac{1}{2g_1}, \nonumber
\\[1.5ex] g_1 &< g_2.
\end{align}

Consider now,
\begin{align*} [G : N_G(Q)] = \frac{eg}{e q k} = \frac{g}{q g_1} = \frac{2 g_2}{i} \in \mathbb{Z}. \tag{by \eqref{6.14a}}
\end{align*}
Thus $i$ divides $2 g_2$. Recall that the order of $A_2$ is relatively prime to $p$ by Theorem \ref{MaximalAbelianSubgroup.IsCyclic_and_card_coprime_CharP_or_eq_Q_join_Z}, so $g_2$ is also relatively prime to $p$. Therefore if $p \neq 2$, $i$ is relatively prime to $p$ and if $p=2$ then $p$ divides $i$ but $p^2$ does not. Now since $Q$ is a Sylow $p$-subgroup of $G$, this means that greatest common denominator of $i$ and $q$ is either 1 or 2.
Now consider,
\begin{align*} [G : N_G(A_2)] = \frac{eg}{2 e g_2} = \frac{g_1 q}{i} \in \mathbb{Z}. \tag{by \eqref{6.14a}}
\end{align*}
Thus $i$ divides $g_1 q$ and since gcd$(i, q) = 1$ or 2, i must divide $2 g_1$. So there exists some $m \in \mathbb{Z^+}$ such that,
\begin{align}\label{6.17} i = \frac{2 g_1}{m}.
\end{align}

We consider now the separate cases which arise for different values of $q$. \\
\\
 \space \textbf{Cases Va and Vb:} $\pmb{q \geq 4}$. This condition gives us a lower bound for the inequality in \eqref{6.16b},
\begin{align*} g_1 > \frac{(q-2) g_2}{q} > \frac{g_2}{2}.
\end{align*}
Combining this with \eqref{6.13} we have,
\begin{align}\label{6.18} g_1 < g_2 < 2 g_1.
\end{align}

Substituting \eqref{6.17} into \eqref{6.16a} gives,
\begin{align*} g_2 = \left( \frac{2}{m} + d g_2 - q \right) g_1
\end{align*}
Thus \eqref{6.18} gives that,
\begin{align*} 1 < \frac{2}{m} + d g_2 - q < 2.
\end{align*}

This means that $2/m$ is some fraction between 0 and 1 and $d g_2 - q = 1$. So \eqref{6.16a} becomes,
\begin{align}\label{6.19} g_2 = g_1 + i.
\end{align}

Substituting this into \eqref{case5b} we find that,
\begin{align*} g_1 q &= i + (q - 2)(g_1 + i),
\\ 2 g_1 &= i(q - 1) = i d g_1, \tag{by \eqref{6.14}}
\\ 2 &= i d.
\end{align*}

We remark that since both $i$ and $d$ are positive integers, $i$ (and indeed $d$) must equal 1 or 2. Thus by \eqref{6.19} and \eqref{6.14a},
\begin{align*} g_1 &= \frac{i(q-1)}{2}, \qquad g_2 = \frac{i(q + 1)}{2}, \qquad g = \frac{2 g_1 g_2 q}{i} = \frac{iq(q^2 - 1)}{2}.
\end{align*}

Thus we have the following expressions for the orders of $K$ and $G$:
\begin{align}\label{orderGK} |K| = \frac{ei(q-1)}{2}, \qquad |G| = \frac{eiq(q^2-1)}{2}.
\end{align}

By Proposition \ref{6.7}, each noncentral element of $Q$ has a unique common fixed point on the projective line $\mathscr{L}$, call it $P_1$. Furthermore, we saw in the proof of Theorem \ref{MaximalAbelianSubgroup.K_mem_MaximalAbelianSubgroups_of_center_lt_card_K} that each noncentral element of $K$ also fixes $P_1$ as well as one other point, call it $P_2$. Let $u$ be a noncentral element of $Q$ and set $P_3 = P_2^u$. Clearly $P_3$ is different from $P_1$ and $P_2$ because otherwise a contradiction is reached. By Theorem \ref{6.6}, $PSL(\mathscr{L})$ is triply transitive, so there exists a $v \in L$ such that,
\begin{align*} P_1^v = R_1 = \begin{bmatrix} 0 \\ 1 \end{bmatrix}, \qquad P_2^v = R_2 = \begin{bmatrix} 1 \\ 0 \end{bmatrix}, \qquad P_3^v = R_3 = \begin{bmatrix} 1 \\ 1 \end{bmatrix}.
\end{align*} 

Observe that,
\begin{align*} vQv^{-1}R_1 &= vQP_1 = vP_1 = R_1,
\\ vKv^{-1}R_i &= vKP_i = vP_i = R_i. \qquad (i=1,2)
\end{align*} 

Thus $vQv^{-1}$ fixes $R_1$ whilst $vKv^{-1}$ fixes both $R_1$ and $R_2$. The only elements of $L$ that fix $R_1$ are the lower triangular matrices, thus  $vQv^{-1} \subset H$, whilst the only elements that fix $R_2$ are the upper triangular matrices, thus $vKv^{-1} \subset D$. Furthermore, each noncentral element of $vQv^{-1}$ has order $p$. The only elements of $H$ with order $p$ are those in $T$, thus $vQv^{-1} \subset T$. Since $u \in Q \setminus I_G$, we have that $v u v^{-1} = t_\gamma$ for some $\gamma \in F$.
\begin{align*} v u v^{-1}R_2 &= v u P_2 = v P_3 = R_3,
\\[1.5ex] \begin{bmatrix} 1 & 0\\ \gamma & 1 \end{bmatrix} \begin{bmatrix} 1 \\ 0 \end{bmatrix} &= \begin{bmatrix} 1 \\ \gamma  \end{bmatrix} \sim \begin{bmatrix} 1 \\ 1 \end{bmatrix}. \Longrightarrow \gamma = 1.
\end{align*}

So $v u v^{-1} = t_1$. If we now consider $\widetilde{G} = vGv^{-1}$ instead of $G$, we can assume without loss of generality that,
\begin{align*} Q \subset T, \qquad K \subset D, \qquad u = t_1.
\end{align*}

Let $x$ be a generator of $K$. By Theorem \ref{MaximalAbelianSubgroup.of_index_normalizer_eq_two} there exists a $y \in N_{\widetilde{G}}(K) \! \setminus \! K$ such that $y x = x^{-1} y$. Since $R_1$ is fixed by both $x$ and $x^{-1}$ we have,
\begin{align*} x^{-1} y R_1 =  y x R_1 = y R_1.
\end{align*}
Thus $x^{-1}$ fixes $y R_1$, that is $y R_1 \in \{ R_1, R_2 \}$. Similarly, $y R_2 \in \{ R_1, R_2 \}$. Assume $y R_1 = R_1$. Since $R_1$ and $R_2$ are distinct points in $\mathscr{L}$ this implies that $y R_2 = R_2$.

\begin{align*} y R_1 = \begin{bmatrix} \alpha & \beta \\ \gamma & \delta \end{bmatrix} \begin{bmatrix} 0 \\ 1 \end{bmatrix} &= \begin{bmatrix} \beta \\ \delta \end{bmatrix} \sim \begin{bmatrix} 0 \\ 1 \end{bmatrix} \Longrightarrow \beta = 0.
\\[1.5ex] y R_2 = \begin{bmatrix} \alpha & \beta \\ \gamma & \delta \end{bmatrix} \begin{bmatrix} 1 \\ 0 \end{bmatrix} &= \begin{bmatrix} \alpha \\ \gamma \end{bmatrix} \sim \begin{bmatrix} 1 \\ 0 \end{bmatrix} \Longrightarrow \gamma = 0.
\end{align*}

Thus $y \in D$, which is a contradiction since elements in $D$ do not invert $x \in D$, hence,
\begin{align}\label{yinterchange} y R_1 = R_2, \qquad \text{and} \quad y R_2 = R_1.
\end{align}
 
This allows us to determine more about $y$,
\begin{align*} y R_1 = \begin{bmatrix} \alpha & \beta \\ \gamma & \delta \end{bmatrix} \begin{bmatrix} 0 \\ 1 \end{bmatrix} &= \begin{bmatrix} \beta \\ \delta \end{bmatrix} \sim \begin{bmatrix} 1 \\ 0 \end{bmatrix} \Longrightarrow \delta = 0.
\\[1.5ex] y R_2 = \begin{bmatrix} \alpha & \beta \\ \gamma & \delta \end{bmatrix} \begin{bmatrix} 1 \\ 0 \end{bmatrix} &= \begin{bmatrix} \alpha \\ \gamma \end{bmatrix} \sim \begin{bmatrix} 0 \\ 1 \end{bmatrix} \Longrightarrow \alpha = 0.
\end{align*}

Thus $y$ is an anti-diagonal matrix. Recalling \eqref{antidiag}, for some $\rho \in F^*$ we have,
\begin{align*} y = d_\rho w = \begin{bmatrix} 0 & \rho \\ -\rho^{-1} & 0 \end{bmatrix}.
\end{align*}

Consider now the set of right cosets of $N_{\widetilde{G}}(Q)$ of the form $N_{\widetilde{G}}(Q) y q$, (where $q \in Q$) in $N_{\widetilde{G}}(Q) y Q$. For $q_1, q_2 \in Q$ we have,
\vspace{2mm}
\begin{align*} N_{\widetilde{G}}(Q) y q_1 = N_{\widetilde{G}}(Q) y q_2 &\iff y q_2 {q_1}^{-1} y^{-1} \in N_{\widetilde{G}}(Q)
\\ &\iff q_2 {q_1}^{-1} \in y^{-1} N_{\widetilde{G}}(Q) y
\\ &\iff (Q \cap y^{-1} N_{\widetilde{G}}(Q) y) q_2 = (Q \cap y^{-1} N_{\widetilde{G}}(Q) y) q_1. \\
\end{align*}

So the number of right cosets of $N_{\widetilde{G}}(Q)$ in $N_{\widetilde{G}}(Q) y Q$ is equal to the number of right cosets of $Q \cap y^{-1} N_{\widetilde{G}}(Q) y$ in $Q$. That is,
\vspace{2mm}
\begin{align}\label{doublecoset} [N_{\widetilde{G}}(Q) y Q : N_{\widetilde{G}}(Q)] = [Q : Q \cap y^{-1} N_{\widetilde{G}}(Q) y]. \\ \nonumber
\end{align}

Let $g$ be an arbitrary element of $N_{\widetilde{G}}(Q)$. By Theorems \ref{6.4i}(i) and \ref{6.7}(ii) we have $N_{\widetilde{G}}(Q) \subset H = \text{Stab}(R_1)$, thus $g$ fixes $R_1$. Using \eqref{yinterchange} we see that,
\vspace{2mm}
\begin{align*} y^{-1} g y R_2 = y^{-1} g R_1 = y^{-1} R_1 = R_2. \\
\end{align*}

Hence $R_2$ is a fixed point of $y^{-1} g y$. Since $g$ was chosen arbitrarily, we assert that each element of $y^{-1} N_{\widetilde{G}}(Q) y$ fixes $R_2$. On the contrary, the only element of $Q$ which fixes $R_2$ is $I_{\widetilde{G}}$, thus $Q \cap y N_{\widetilde{G}}(Q) y^{-1} = I_{\widetilde{G}}$.
\vspace{2mm}
\begin{align}\label{qwed} [N_{\widetilde{G}}(Q) y Q : N_{\widetilde{G}}(Q)] &= [Q : Q \cap y^{-1} N_{\widetilde{G}}(Q) y] = q, \nonumber
\\[1ex] |N_{\widetilde{G}}(Q) y Q| &= q|N_{\widetilde{G}}(Q)|. \\ \nonumber
\end{align}

We show next that $N_{\widetilde{G}}(Q) y Q \cap N_{\widetilde{G}}(Q) = \varnothing$. Let $t_\lambda d_\omega$ and $t_\mu$ be arbitrarily chosen from $N_{\widetilde{G}}(Q)$ and $Q$ respectively so that $t_\lambda d_\omega y t_\mu$ is an arbitrary element of $N_{\widetilde{G}}(Q) y Q$.
\begin{align}\label{onemore} t_\lambda d_\omega y t_\mu &= \begin{bmatrix} 1 & 0 \\ \lambda & 1 \end{bmatrix} \begin{bmatrix} \omega & 0 \\ 0 & \omega^{-1} \end{bmatrix} \begin{bmatrix} 0 & \rho \\ -\rho^{-1} & 0 \end{bmatrix}  \begin{bmatrix} 1 & 0 \\ \mu & 1 \end{bmatrix} \nonumber
\\[1.5ex] &= \begin{bmatrix} \omega & 0 \\ \omega \lambda & \omega^{-1} \end{bmatrix} \begin{bmatrix} \rho \mu & \rho \\ -\rho^{-1} & 0 \end{bmatrix} \nonumber
\\[1.5ex] &= \begin{bmatrix} \omega \rho \mu & \omega \rho  \\ \omega \lambda \rho \mu - \omega^{-1} \rho^{-1} & \omega \rho \lambda \end{bmatrix}.
\end{align}

Since $\omega$, $\rho \in F^*$, the top right entry of \eqref{onemore} is non-zero. Recall also that $N_{\widetilde{G}}(Q) \subset H$ by Theorem \ref{6.4i}(i) and that $H$ is the set of all lower triangular matrices of $L$. Since $t_\lambda d_\omega d_\rho w t_\mu$ was chosen arbitraily, no element of $N_{\widetilde{G}}(Q) y Q$ is in $H$ whilst the whole of $N_{\widetilde{G}}(Q)$ is contained in $H$, thus they are disjoint. Using \eqref{qwed} and \eqref{orderGK} we also observe that,
\begin{align*} |N_{\widetilde{G}}(Q) y Q| + |N_{\widetilde{G}}(Q)| = (q+1)|N_{\widetilde{G}}(Q)| = (q+1)eqg_1 = \frac{eiq(q^2-1)}{2} = |{\widetilde{G}}|.
\end{align*}
Since $N_{\widetilde{G}}(Q) y Q$ and $N_{\widetilde{G}}(Q)$ are disjoint and the sum of their orders is equal to the order of ${\widetilde{G}}$, they partition ${\widetilde{G}}$ into the set of elements that belong to $H$ and the set that don't.
\begin{align}\label{gsplit} {\widetilde{G}} = N_{\widetilde{G}}(Q) y Q \cup N_{\widetilde{G}}(Q).
\end{align}

Let $\mathbb{N} = \{ \lambda : t_\lambda \in Q \}$. We will show that $\mathbb{N} =\mathbb{F}_q$. For each $t_\lambda \in Q \setminus Z$, the element $y t_\lambda y^{-1} \notin H$, so by $\eqref{gsplit}$, $y t_\lambda y^{-1} \in N_{\widetilde{G}}(Q) y Q$. Thus there exists $t_\mu, t_\upsilon \in Q$ and $d_\omega \in K$ such that,
\begin{align*} y t_\lambda y^{-1} &= t_\mu d_\omega y t_\upsilon,
\\[1.5ex] \begin{bmatrix} 0 & \rho \\ -\rho^{-1} & 0 \end{bmatrix}\begin{bmatrix} 1 & 0 \\ \lambda & 1 \end{bmatrix}\begin{bmatrix} 0 & -\rho \\ \rho^{-1} & 0 \end{bmatrix} &= \begin{bmatrix} 1 & 0 \\ \mu & 1 \end{bmatrix}\begin{bmatrix} \omega & 0 \\ 0 & \omega^{-1} \end{bmatrix}\begin{bmatrix} 0 & \rho \\ -\rho^{-1} & 0 \end{bmatrix}\begin{bmatrix} 1 & 0 \\ \upsilon & 1 \end{bmatrix},
\\[1.5ex] \begin{bmatrix} 0 & \rho \\ -\rho^{-1} & 0 \end{bmatrix}\begin{bmatrix} 0 & -\rho \\ \rho^{-1} & -\rho \lambda \end{bmatrix} &= \begin{bmatrix} \omega & 0 \\ \omega \mu & \omega^{-1} \end{bmatrix}\begin{bmatrix} \rho \upsilon & \rho \\ -\rho^{-1} & 0 \end{bmatrix},
\\[1.5ex] \begin{bmatrix} 1 & -\rho^2 \lambda \\ 0 & 1 \end{bmatrix} &= \begin{bmatrix} \omega \rho \upsilon & \omega \rho \\ \omega \rho \mu \upsilon - \omega^{-1} \rho^{-1} & \omega \rho \mu \end{bmatrix}.
\end{align*}

Equating the top right entries gives,
\begin{align}\label{mattr} \omega = -\rho \lambda.
\end{align}

Since $t_1 \in Q$, so is it's inverse, thus $-1 \in \mathbb{N}$. Letting $\lambda = -1$ in \eqref{mattr} gives $\omega = \rho$, which means that $d_\rho \in K$. Consequently, this shows that $w = d_\rho^{-1} y \in {\widetilde{G}}$ and we may replace $y$ by $w$ in \eqref{gsplit} without it affecting the partition of ${\widetilde{G}}$. This is equivalent to letting $\rho = 1$, and \eqref{mattr} simplifies to,
\begin{align}\label{mattr2} \omega = -\lambda.
\end{align}

Let $\mathbb{M} = \{ \omega : d_\omega \in K \}$. Recall from \eqref{orderGK} that $|K| = i(q-1)$. We consider the different cases which arise depending on the values of $i$ and $e$. \\
\\
Let \textbf{Case Va} be the case when $e=1$ or $i = 1$. Observe that $i$ and $e$ cannot both equal 1, since this would imply that 2 divides $q-1$ (by \eqref{orderGK}), but if $e=1$ it follows that $q-1$ is even. Hence $ei = 2$ and $K$ has order $q-1$. Furthermore, the order of each element of $K$ divides $q-1$, so for each $\omega \in \mathbb{M}$,
\begin{align}
    \label{roots} \omega^{q-1} = 1.
\end{align}
Also, the following polynomial has at most $q-1$ roots in $F$.
\begin{align}\label{rootsx} x^{q-1} = 1.
\end{align}
By \eqref{subfield}, $\mathbb{F}_q \subset F$ and each element of $\mathbb{F}^*_q$ is a root of \eqref{rootsx}. Thus each $\omega$ of $\mathbb{M}$ is in $\mathbb{F}^*_q$ and since they have the same cardinality, $\mathbb{M} = \mathbb{F}^*_q$. By \eqref{mattr2}, $\lambda$ also ranges over $\mathbb{F}^*_q$ and considering also that $\lambda$ can be 0, we have $\mathbb{N} =\mathbb{F}_q$. \\
\\
Observe that each element of ${\widetilde{G}}$ is either of the form $t_\lambda d_\omega$ or $t_\lambda d_\omega w t_\mu$ (where $\lambda, \mu \in \mathbb{F}_q$, $\omega \in \mathbb{F}^*_q$), so ${\widetilde{G}} \subset \SL_2(\mathbb{F}_q)$. Also, Propostion \ref{ordersl2q} gives that, $|\SL_2(\mathbb{F}_q)| = q(q^2-1) = |{\widetilde{G}}|$, so ${\widetilde{G}} = \SL_2(\mathbb{F}_q)$. Since ${\widetilde{G}}$ is conjugate in $L$ to $G$, we have $G \cong \SL_2(\mathbb{F}_q)$  as desired. \\
\\
Let \textbf{Case Vb} be the case when $i = 2 = e$. This time the order of each element of $K$ divides $2(q-1)$, so for each $\omega \in \mathbb{M}$,
\begin{align}
    \label{roots} \omega^{2(q-1)} = 1.
\end{align}
As in the case of $i=1$, each element of $\mathbb{F}^*_q$ is a root of the polynomial in \eqref{rootsx}, as are each $\omega^2$. Thus $\omega^2$ ranges over $\mathbb{F}^*_q$ and by \eqref{subfield}, $\omega \in \mathbb{F}_{q^2} \setminus \mathbb{F}_q$. Simple matrix multiplication shows that, \\
\begin{align*} d_\omega^{-1} t_\lambda d_\omega = t_{\omega^2 \lambda}.
\end{align*}
Hence since $t_0, t_1 \in Q$, it follows that $t_{\omega^2} \in Q$ for each $\omega^2 \in \mathbb{F}^*_q$, thus $\mathbb{N} = \mathbb{F}_q$. Since $K$ is a cyclic group of order $2(q-1)$, so too is $\mathbb{M}$. Let $\pi$ be a generator of $\mathbb{M}$. It follows that $\pi^2$ has order $q-1$ and is therefore a generator of $\mathbb{F}^*_q$. Since $K = \langle d_\pi \rangle$, we have:
\begin{align*} {\widetilde{G}} = \langle t_\lambda, d_\pi, w : \lambda \in \mathbb{F}_q \rangle = \langle \SL_2(\mathbb{F}_q), d_\pi \rangle.
\end{align*}
Again, since ${\widetilde{G}}$ is conjugate in $L$ to $G$, we have $G \cong \langle \SL_2(\mathbb{F}_q), d_\pi \rangle$ as desired. Now we take an arbitrary $x$ from $\SL_2(\mathbb{F}_q)$ and conjugate it by $d_\pi$.
\begin{align*} d_\pi x d_\pi^{-1} &= \begin{bmatrix} \pi & 0 \\ 0 & \pi^{-1} \end{bmatrix} \begin{bmatrix} \alpha & \beta \\ \gamma & \delta \end{bmatrix}\begin{bmatrix} \pi^{-1} & 0 \\ 0 & \pi \end{bmatrix}
\\[1.5ex] &=  \begin{bmatrix} \pi & 0 \\ 0 & \pi^{-1} \end{bmatrix}  \begin{bmatrix} \alpha \pi^{-1} & \beta \pi \\ \gamma \pi^{-1} & \delta \pi \end{bmatrix}
\\[1.5ex] &= \begin{bmatrix} \alpha & \beta \pi^{-2} \\ \gamma \pi^{2} & \delta \end{bmatrix}. 
\end{align*}
Since $\pi^2 \in \mathbb{F}_q$, we have that $d_\pi x d_\pi^{-1} \in \SL_2(\mathbb{F}_q)$ and since $x$ was chosen arbitrarily, $d_\pi$ belongs to the normaliser of $\SL_2(\mathbb{F}_q)$ in $\langle \SL_2(\mathbb{F}_q), d_\pi \rangle$. This shows that $\SL_2(\mathbb{F}_q) \vartriangleleft \langle \SL_2(\mathbb{F}_q), d_\pi \rangle$ as desired. \\
\\
 \space \textbf{Cases Vc and Vd:} $\pmb{q \leq 3}$. Since $q - 1 = d g_1 \geq 2$ by \eqref{6.14}, $q$ cannot equal 2. So $q = 3 = p$, $e = 2$ and thus $g_1 = 2$. The inequalities in \eqref{6.13} and \eqref{6.16b} give,
\begin{align*} 2 < g_2 < 6.
\end{align*}
Also, since $g_2$ is relatively prime to $p=3$, we have $g_2 = 4$ or 5. Let \textbf{Case Vc} be the case when $g_2 = 4$. \eqref{case5b} becomes,
\begin{align*} \frac{1}{8} = \frac{1}{g} + \frac{1}{4} - \frac{1}{6},
\end{align*}

which gives $g = 24$. Observe that,
\begin{align*} |K| = 4 = i(q-1), \qquad |G| = 48 = iq(q^2-1),
\end{align*}
where $i=2$, thus we have the situation as described in Case Vb. That is, $G \cong \langle \SL_2(\mathbb{F}_q), d_\pi \rangle$ with $q=3$.\\
\\
Alternatively, \textbf{Case Vd} occurs when $g_2 = 5$. \eqref{case5b} becomes,
\begin{align*} \frac{1}{10} = \frac{1}{g} + \frac{1}{4} - \frac{1}{6}.
\end{align*}

Thus $g = 60 $ and $|G| = 120$. We verify, using Proposition \ref{ordersl2q}, that $\SL_2(5)$ has the same order as $G$, that is $|\SL_2(5)| = 5(5^2-1) =120$. Observe that,
\begin{align*} |\mathcal{C}_1| &= [G : N_G(A_1)] = \frac{eg}{2eg_1} = 15,
\\[1ex] |\mathcal{C}_2| &= [G : N_G(A_2)] = \frac{eg}{2eg_2} = 6,
\\[1ex] |\mathcal{C}_{Q \times Z}| &= [G : N_G(Q \times Z)] = \frac{eg}{ekq} = 10.
\end{align*}

Now consider the quotient group $G / Z$ of order 60. It's trivial that for all $A_i, A_j \in \mathfrak{M}$, $A_i / Z$ belongs to the same conjugacy class as $A_j / Z$ if and only $A_i$ and $A_j$ belong to the same conjugacy class. So the number of subgroups conjugate to $A_i / Z$ is $|\mathcal{C}_i|$. Similarly, the number of subgroups conjugate to $(Q\times Z) / Z$ is $|\mathcal{C}_{Q \times Z}|$. \\
\\
We now calculate the order of each maximal abelian subgroup of $G$ when we quotient out $Z$.
\begin{align*} |A_1 / Z| = 2, \qquad |A_2 / Z| = 5, \qquad |(Q \times Z) / Z| = 3.
\end{align*}

We now know enough about $G / Z$ to determine the order of each of it's elements: \\
\\
 \space The identity has order 1.gives \\
 \space The non-central element of $A_1 / Z$ has order 2, as does the non-central element in each of the $|\mathcal{C}_1| = 15$ subgroups conjugate to $A_1 / Z$. So there are $15$ elements of order 2. \\
 \space The 4 non-central elements of $A_2 / Z$ have order 5, as do the non-central elements in each of the $|\mathcal{C}_2| = 6$ subgroups conjugate to $A_2 / Z$. Thus there are $24$ elements of order 5. \\
 \space  The 2 non-central elements of $(Q \times Z) / Z$ have order 3, as do the non-central elements in each of the $|\mathcal{C}_{Q \times Z}| = 10$ subgroups conjugate to $(Q \times Z) / Z$. Thus there are $20$ elements of order 3. \\
\\
Since $1+15+24+20=60$, all elements of $G / Z$ are accounted for. \\
\\
Let $N$ be a normal subgroup of $G / Z$. Observe that each non-central element of $A_2 / Z$ is a generator of it, so if $N$ contains one non-central element of $A_2 / Z$, then it contains the whole of it, due to the closure of the group under multiplication and the fact that each element of $A_2 / Z$ is a power of any non-central element. Also, it can easily be seen that normal subgroups are composed of whole conjugacy classes, so since $N$ is normal in $G$, if it contains $A_2 / Z$, it must contain all subgroups conjugate to $A_2 / Z$. The consequence of this is that if $N$ has an element of order 5, then it contains all 24 elements of $G / Z$ of order 5. Similarly, if it contains an element of order 2, it contains all 15 of them and if it contains an element of order 3, it contains all 20 of them. This means that $|N|$ is partitioned by some or all of the elements in $\{ 1, 15, 20, 24 \}$. Bearing in mind that the order of $N$ divides 60 and that $N$ contains the identity element, this means that $N$ is equal to either the identity element or it is the whole of $G / Z$, since it's easy to see that no other partition of those numbers divides 60. Thus $G / Z$ has no non-trivial normal subgroups and is simple. \\
\\
By \cite[p.145]{dummit}, the only simple groups of order 60 are those isomorphic to the alternating group $A_5$ (not to be confused with an element of $\mathfrak{M}$), thus $G / Z \cong A_5$. Since $Z \cong \mathbb{Z}_2$, we have that $G$ is isomorphic to a central extension of $A_5$ which, according to Schur \cite{schur}, is unique and isomorphic to $\SL_2(5)$ as desired. The proofs of these 2 claims are beyond the scope of this thesis. \qedhere

\end{proof}

\begin{theorem}[Case VI]
\label{case_VI}
\uses{card_noncenter_fin_subgroup_eq_sum_card_noncenter_mul_index_normalizer, MaximalAbelianSubgroup.of_index_normalizer_eq_two}
\lean{case_VI}
Claim: \textit{We have one of the following three cases: \\
\\
(i) $G = \langle \, x,y \, | \, x^n = y^2, \, yxy^{-1} = x^{-1} \, \rangle$, where $n$ is even. \\
\\
(ii) $G = \widehat{S}_4$. \\
\\
(iii) $G \cong \SL_2(5)$ and $p$ does not divide $|G|$. \\
\\
Where $\widehat{S}_4$ is one of the representation groups of the symmetric group $S_4$ in which the transpositions correspond to the elements of order 4.} \\
\end{theorem}
% DEPENDENCIES AND STATEMENT

\begin{proof} Here, $s = 0$ and $t = 3$. Equation \eqref{classeq} simplifies to:
\begin{align} \label{case6a} 1 &= \frac{1}{g} + \frac{q-1}{qk} + \frac{g_1 -1}{2g_1} + \frac{g_2 -1}{2g_2} + \frac{g_3 -1}{2g_3}, \nonumber
\\[1ex] \frac{1}{2g_1} + \frac{1}{2g_2} + \frac{1}{2g_3} &= \frac{1}{g} + \frac{q-1}{qk} + \frac{1}{2}.
\end{align}

First assume that $q > 1$ and $k=1$. \eqref{case6a} is thus bounded as follows,
\begin{align*} \frac{3}{4} > \frac{1}{2g_1} + \frac{1}{2g_2} + \frac{1}{2g_3} &= \frac{1}{g} + \frac{q-1}{qk} + \frac{1}{2} > 1,
\end{align*}
which is a contradiction. Now assume that $q > 1$ and $k > 1$. This means that $k=g_i$ for some $i$. Without loss of generality we can assume that $k=g_1$. Now \eqref{case6a} becomes,
\begin{align*} \frac{1}{2} \geq \frac{1}{2g_2} + \frac{1}{2g_3} &\geq \frac{1}{g} + \frac{1}{2} > \frac{1}{2},
\end{align*}
which again is a contradiction, thus we conclude that $q=1$. \eqref{case6a} simplifies and we can now determine the possible values of each $g_i$.
 \begin{align} \label{case6b} \frac{1}{2g_1} + \frac{1}{2g_2} + \frac{1}{2g_3} &= \frac{1}{g} + \frac{1}{2}.
\end{align}

Without loss of generality we may assume that $2 \leq g_1 \leq g_2 \leq g_3$. If $g_1 \neq 2$ we arrive at the following contradiction
\begin{align*} \frac{1}{6} + \frac{1}{6} + \frac{1}{6} \geq \frac{1}{2g_1} + \frac{1}{2g_2} + \frac{1}{2g_3} &= \frac{1}{g} + \frac{1}{2}.
\end{align*}
Thus $g_1 = 2$ and we have,
\begin{align}\label{case6c} \frac{1}{2g_2} + \frac{1}{2g_3} > \frac{1}{4}.
\end{align}
\newpage
Clearly $g_2$ must equal either 2 or 3. If $g_2 = 2$ it is easily shown that $g=2 g_3$. If $g_2 = 3$ we see that $g_3 \in \{ 3,4,5 \}$. Assume that $g_2$ and $g_3 = 3$. Notice that since  $g_1 = 2$, 2 must divide the order of $G$. Recall also that a Sylow $p$-subgroup of $G$ has order 1, so we assert that $p \neq 2$ and $e=2$. We see from \eqref{case6b} that $|G| = 24$ and thus a Sylow $3$-subgroup has order 3. The maximal abelian subgroups conjugate to $A_2$ or $A_3$ have order 6 and therefore each contains a Sylow $3$-subgroup of $G$. Let $B_2$ and $B_3$ be the Sylow $3$-subgroups contained in $A_2$ and $A_3$ respectively. Observe that for $i = 2$ or 3,
\begin{align}\label{case6d} A_i \cong \mathbb{Z}_6 \cong \mathbb{Z}_3 \times \mathbb{Z}_2 \cong B_i \times Z \cong B_i Z. 
\end{align}
Let $b_2 \in B_2$, $b_3 \in B_3$ and $z \in Z$. Recall that $B_2$ and $B_3$ are conjugate in $G$ by Sylow's Second Theorem, so there exists an $x \in G$ such that,
\begin{align*} x b_2 x^{-1} &= b_3,
\\ x b_2 x^{-1} z &= b_3 z,
\\ x b_2 z x^{-1} &= b_3 z.
\end{align*} 
Since $b_2$, $b_3$ and $z$ were chosen arbitrarily, we observe that $B_2 Z$ is conjuagate to $B_3 Z$ and thus by \eqref{case6d}, $A_2 \cong A_3$. This contradicts the fact that $A_2$ and $A_3$ are representatives of different conjugacy classes of maximal abelian subgroups of $G$, which means that $g_2$ and $g_3$ cannot both equal 3. Thus we are left with the following three cases:
\begin{align*} g_1 = 2, \qquad g_2&=2, \qquad g=2 g_3.
\\[1ex] g_1 = 2, \qquad g_2&=3, \qquad g_3 = 4.
\\[1ex] g_1 = 2, \qquad g_2&=3, \qquad g_3 = 5.
\end{align*}
\\
 \space \textbf{Case VIa:} $\pmb{g_1 = 2, g_2 = 2, g=2 g_3}$. First observe that,
\begin{align*} [G : N_G(A_1)] = \frac{eg}{2eg_1} = \frac{g_3}{2}.
\end{align*}
Thus $g_3/2$ is an integer which means that $g_3$ must be even, call it $n$. Now let $A_3 = \langle x \rangle$. Since $|A_3| = eg_3$, the order of $x$ is $2n$ and $x^n$ has order 2. By Theorem \eqref{6.8}(iv) there exists a $y \in N_G(A_3) \! \setminus \! A_3$ such that $y x y^{-1} = x^{-1}$. Also,
\begin{align*} |\mathcal{C}_3| = [G : N_G(A_3)] = 1.
\end{align*}
Since $y \not \in A_3$ and $A_3$ has no conjugate subgroups (aside from itself), $y$ must lie in a maximal abelian subgroup conjugate to either $A_1$ or $A_2$. This means that since $|A_1| = 4 = |A_2|$ and $y \not \in Z$, the order of $y$ must be 4. By the uniqueness of the element of order 2, we have the relation $x^n = y^2$ and $G$ is given by the presentation,
\begin{align*} G = \langle \, x,y \, | \, x^n = y^2, \, yxy^{-1} = x^{-1} \, \rangle. \qquad \text{(where $n$ is even)}
\end{align*}

 \space \textbf{Case VIb:} $\pmb{g_1 = 2, g_2 = 3, g_3 = 4}$. In this case \eqref{case6b} becomes,
\begin{align*} \frac{1}{4} + \frac{1}{6} + \frac{1}{8} &= \frac{1}{g} + \frac{1}{2}.
\end{align*}
Thus $g = 24$ and $|G| = 48$. Consider the quotient group $G / Z$ of order 24 and the quotient group $N_G(A_2) / Z$ which, for convenience, we will call $H$.
\begin{align*} |H| = \frac{2eg_2}{e} = 6.
\end{align*}

Let $x$ be an element of order 6 from $A_2$. By Theorem \ref{MaximalAbelianSubgroup.of_index_normalizer_eq_two} there exists a $y \in N_G(A_2) \! \setminus \! A_2$ such that $y x = x^{-1} y$. Thus for $xZ, yZ, x^{-1}Z \in H$ we have,
\begin{align*} yZ xZ = yxZ =  x^{-1}yZ = x^{-1}Z yZ.
\end{align*}
If $H$ is abelian, then $xZ = x^{-1}Z$ and thus $x^2 \in Z$. Also, since $x$ has order 6, $x^2$ has order 3. This is contradiction since there is no element of order 3 in $Z$. Thus $H$ is non-abelian and is therefore isomorphic to the symmetric group $S_3$. \\
\\
Now we determine the normal subgroups of $H$. The identity and $H$ itself are trivially normal. Furthermore, the elementary result that any subgroup of index 2 is normal implies that $A_2 / Z$, the subgroup of $H$ of order 3, is normal. It remains to check the subgroups of order 2. Let r be a generator of one of the subgroups of order 2 and let $x$ be an arbitrary element of $H$. If $\langle r \rangle$ is normal in $H$, then $x r x^{-1} \in \{ I , r \}$. Since $r \neq I$ it follows that $x r x^{-1} \neq I$. Alternatively if $x r x^{-1} = r$, then $r \in Z(H)$. By the elementary result that $Z(S_n) = \{ I \}$ for $n > 2$, we have that $Z(H) = \{ I \}$ and the contradiction $r=I$. Thus $x r x^{-1} \not \in \langle r \rangle$ and $H$ has no normal subgroup of order 2. We conclude that the only normal subgroups of $H$ are those of order 1, 3 or 6. \\
\\
Note that the index of $H$ in $G / Z$ is 4. Let $G / Z$ act by left multiplication on the set of left cosets of $H$. By Theorem \ref{symhomoker}, this action induces a homomorphism $\phi : G / Z \longrightarrow S_4$ with kernel,
\begin{align*} ker(\phi) = \bigcap\limits_{x \in G / Z} x H x^{-1}  \subset H.
\end{align*}

Recall the elementary result that the kernel of a homomorphism is a normal subgroup of it's domain. Thus the kernel of $\phi$ is normal in $G / Z$ and consequently in $H$ as well, that is $ker(\phi) \in\{ I , A_2 / Z, H \}$. \\
\\
If $ker(\phi) = A_2 / Z$, then $A_2 / Z \vartriangleleft G / Z$ and by Lemma \ref{QuotientGroup.comapMk'OrderIso} $A_2 \vartriangleleft G$. This is a contradiction since the normaliser in $G$ of $A_2$ is a proper subgroup of $G$, thus $ker(\phi) \neq A_2 / Z$. \\
\\
If $ker(\phi) = H$, then $H \vartriangleleft G / Z$. Take an arbitrary $x \in G / Z$. Since $A_2 / Z$ is a subgroup of $H$ we get,
\begin{align*} x (A_2 / Z) x^{-1} \subset H.
\end{align*}
Furthermore, since $A_2 / Z$ has order 3, any subgroup conjugate to it has order 3. Since the only subgroup of $H$ of order 3 is $A_2 / Z$, and since $x$ was chosen arbitrarily, $A_2 / Z \vartriangleleft G / Z$. We have already shown that this leads to a contradiction, thus $ker(\phi) \neq H$. \\
\\
We conclude that $ker(\phi) = \{ I \}$ and so $\phi$ is injective. Since $G / Z$ has 24 elements, it's image under $\phi$ is the whole of $S_4$, that is $G / Z \cong S_4$. Thus $G$ is a \textit{representation group} of $S_4$, denoted by $\widehat{S}_4$ (for a full defintion of this, see \cite{suzuki}). Suzuki proves that $S_4$ has 2 distinct representation groups up to isomorphism \cite[p.301]{suzuki}, which are distinguished by the property that the elements corresponding to transpositions have either order 2 or order 4. Since $G$ has a unique element of order 2, it must be isomorphic to the representation group of $S_4$ in which the transpositions correspond to the elements of order 4, as desired.\\
\\
 \space \textbf{Case VIc:} $\pmb{g_1 = 2, g_2 = 3, g_3 = 5}$.  In this case \eqref{case6b} becomes,
\begin{align*} \frac{1}{4} + \frac{1}{6} + \frac{1}{10} &= \frac{1}{g} + \frac{1}{2}.
\end{align*}
Thus $|g| = 60$ and $|G| = 120$. Observe that a simple relabelling of the maximal abelian subgroups gives the same situation as described in \textbf{Case Vd:}. Thus $G \cong \SL_2(5)$, however in this case $p$ does not divide $|G|$.

\end{proof}

\section{Dickson's Classification Theorem}

We now state the main result of this paper, Dickson's classification of finite subgroups of $\SL_2(F)$. Observe that it is not the focus of this paper to determine whether the following groups actually exist, rather that this theorem can be regarded as an \textit{upper bound}, so to speak, of the only possible subgroups of $\SL_2(F)$.\\

\begin{theorem}[Class I]
    \label{dicksons_classification_theorem_class_I}
    \uses{case_I, case_II, case_III, case_VI}
    \lean{dicksons_classification_theorem_class_I} Let $F$ be an arbitary algebraically closed field of characteristic $p$. Any finite subgroup $G$ of $\SL_2(F)$ is isomorphic to one of the following groups. \vspace{3mm} \\
: When $p=0$ or $|G|$ is relatively prime to $p$: \vspace{1mm} \\
(i) A cyclic group. \vspace{3mm} \\
(ii) The group defined by the presentation:
\begin{equation*} \langle \, x,y \, | \, x^n = y^2, \, yxy^{-1} = x^{-1} \, \rangle.
\end{equation*}
(iii) The Special Linear Group $\SL_2(3)$. \vspace{3mm} \\
(iv) The Special Linear Group $\SL_2(5)$. \vspace{3mm} \\
(v) $\widehat{S}_4$, the representation group of $S_4$ in which the transpositions correspond to the elements of order $4$. \\
\\
\end{theorem}
% DEPENDENCIES
\begin{proof}
    Case Ia: This leads to Class I (i). \\
    Case IIa: This leads to Class I (ii) where $n$ is odd. \\
    Case IIb: This leads to Class I (iii). \\
    Case III where $G=Z$: This leads to Class I (i).\\
    Case VIa: This leads to Class I (ii) where $n$ is even. \\
    Case VIb: This leads to Class I (v). \\
    Case VIc: This leads to Class I (iv). \\
    
\end{proof}

\begin{theorem}[Class II]
    \label{dicksons_classification_theorem_class_II}
    \uses{case_I, case_III, case_IV, case_V}
    \lean{dicksons_classification_theorem_class_II}
    When $|G|$ is divisible by $p$: \vspace{1mm} \\
(vi) $Q$ is elementary abelian, $Q \vartriangleleft G$ and $G/Q$ is a cyclic group whose order is relatively prime to $p$. \vspace{3mm} \\
(vii) $p=2$ and $G$ is a dihedral group of order $2n$, where $n$ is odd. \vspace{3mm} \\
(viii) The Special Linear Group $\SL_2(5)$, where $p=3=q$. \vspace{3mm} \\
(ix) The Special Linear Group $\SL_2(\mathbb{F}_q)$. \vspace{3mm} \\
(x) The group $\langle \SL_2(\mathbb{F}_q), d_\pi \rangle$, where $\SL_2(\mathbb{F}_q) \vartriangleleft \langle \SL_2(\mathbb{F}_q), d_\pi \rangle$. \vspace{3mm} \\

Here, $Q$ is a Sylow $p$-subgroup of $G$ of order $q$, $\mathbb{F}_q$ is a field of $q$ elements, $\mathbb{F}_{q^2}$ is a field of $q^2$ elements, $\pi \in \mathbb{F}_{q^2} \setminus \mathbb{F}_q$ and $\pi^2 \in \mathbb{F}_q$. \vspace{3mm}
\end{theorem}

\begin{proof}% \\
% If $Z \subset G$, then $G$ has the same structure as one of the 6 cases previously discussed. We match the separate cases to the above classes. \\
% \\

Case Ib: This leads to Class II (vi). \\
Case III where $G \ne Z$: This leads to Class II (vi). \\
Case IVa: This leads to Class II (vii). \\
Case IVb: This leads to Class II (ix) with $q=3$. \\
Case Va: This leads to Class II (ix). \\
Case Vb: This leads to Class II (x). \\
Case Vc: This leads to Class II (x) with $q=3$. \\
Case Vd: This leads to Class II (viii). \\
\end{proof}

\begin{lemma}
    If $Z \not \subset G$, then $G$ has no element of order 2 and $|G|$ is therefore odd. Observe that in Cases II, IV, V and VI, $|G|$ is always even, thus we have either Case I or III. These correspond to Class I (i) or Class II (vi). \\
\end{lemma}

\section{Classification of finite subgroups of $\PGL_2(\Fbar_p)$}

\begin{theorem}[Classification of finite subgroup of $\PGL_2(\Fbar)$]
    \label{FLT_classification_fin_subgroups_of_PGL2_over_AlgClosure_ZMod}
    \uses{dicksons_classification_theorem_class_II, dicksons_classification_theorem_class_I, PGL_iso_PSL, SpecialSubgroups.center_SL2_eq_Z}
    \lean{FLT_classification_fin_subgroups_of_PGL2_over_AlgClosure_ZMod}
    Let $G$ be a finite subgroup of $\PGL_2(\Fbar_p)$ then $G$ is isomorphic to either a cyclic group, a dihedral group, $A_4$, $S_5$, $A_5$, or is isomorphic to $\PSL_2(k)$ or $\PGL_2(k)$ for some finite field $k$ of characteristic $p$.
\end{theorem}
% DEPENDENCY AND PROOF